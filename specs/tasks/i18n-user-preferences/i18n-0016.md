# 0016: Zod i18n error map

## Context

Zod validation errors ("Required", "Expected number") appear in English by default. Create a custom error map that reads from i18n translation files so form validation messages match the active language.

## Dependencies

- 0001 (i18n instance)
- 0008, 0009 (error translations in `errors.json`)

## Files

- `src/lib/validators/i18n-error-map.ts` (new)
- `src/i18n/index.ts` (edit — register error map after init)

## Requirements

### Error map

```ts
import i18n from '@/i18n'
import { z } from 'zod'
```

Use `z.setErrorMap()` to override default messages. Map common issue codes:

- `invalid_type` (required) → `t('errors:validation.required')`
- `too_small` (min) → `t('errors:validation.tooSmall', { minimum })`
- `too_big` (max) → `t('errors:validation.tooBig', { maximum })`
- `invalid_string` (email) → `t('errors:validation.invalidEmail')`
- `custom` → use message as-is or look up key

### Registration

Call `z.setErrorMap(i18nErrorMap)` in `src/i18n/index.ts` after `i18n.init()` completes. Since init is synchronous with bundled resources, this runs immediately.

### Language reactivity

The error map function is called at validation time, not at registration time. Since it calls `i18n.t()` each time, it automatically uses the current language. No re-registration needed on language change.

## Resources

- [Zod error handling docs](https://zod.dev/error-handling)
- [i18next t() function](https://www.i18next.com/overview/api#t)

## Definition of Done

- [ ] `src/lib/validators/i18n-error-map.ts` created
- [ ] Error map registered in i18n init module
- [ ] Common zod errors show in Spanish by default
- [ ] Switching to English shows English validation messages
- [ ] Existing form validations work without changes to individual schemas
