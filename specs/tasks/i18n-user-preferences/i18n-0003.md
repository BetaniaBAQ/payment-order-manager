# 0003: Preferences Zustand store

## Context

Client-side store for instant language/theme switching. Persisted to localStorage so preferences survive refresh before DB sync completes. Follows existing `uiStore.ts` pattern.

## Dependencies

- 0001 (needs `Language` type from `src/i18n`)

## Files

- `src/stores/preferencesStore.ts` (new)

## Requirements

Follow `.claude/rules/zustand.md` pattern exactly:

```ts
import type { Language } from '@/i18n'
import { create } from 'zustand'
import { devtools, persist } from 'zustand/middleware'

type Theme = 'light' | 'dark'

interface PreferencesState {
  language: Language
  theme: Theme
}

interface PreferencesActions {
  actions: {
    setLanguage: (language: Language) => void
    setTheme: (theme: Theme) => void
    setPreferences: (prefs: Partial<PreferencesState>) => void
  }
}
```

- Initial state: `language: 'es'`, `theme: 'dark'`
- Store name: `'preferences-store'` (persist), `'PreferencesStore'` (devtools)
- Action names for devtools: `'actions/setLanguage'`, `'actions/setTheme'`, `'actions/setPreferences'`
- `setPreferences` â€” batch update both fields at once (used during DB sync)
- Export atomic selectors: `useLanguage()`, `usePreferredTheme()`
- Export actions hook: `usePreferencesActions()`

## No-gos

- Do not export the raw store
- Do not put actions at root level (SSR crash per zustand rules)

## Definition of Done

- [ ] `src/stores/preferencesStore.ts` follows zustand rules (actions under `actions` property)
- [ ] Exports: `useLanguage()`, `usePreferredTheme()`, `usePreferencesActions()`
- [ ] localStorage key: `preferences-store`
- [ ] No TypeScript errors
