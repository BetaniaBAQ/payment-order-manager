# 0005: Preferences header dropdown

## Context

Replace the plain email + "Sign out" section in `AppHeader` with a dropdown menu that exposes language switching, theme switching, and sign out. Uses existing shadcn `DropdownMenu` component.

## Dependencies

- 0001 (LANGUAGE_CONFIG, SUPPORTED_LANGUAGES)
- 0003 (preferences store)
- 0002 (users.update mutation for DB persist)

## Files

- `src/components/shared/preferences-dropdown.tsx` (new)
- `src/components/shared/app-header.tsx` (edit)

## Requirements

### `PreferencesDropdown`

Props: `userId: Id<'users'>`, `authKitId: string`

Structure:

```
[Trigger: user email + chevron icon]
  â”œâ”€ Label: "Idioma" / "Language"
  â”œâ”€ MenuItem: Espanol [check if active]
  â”œâ”€ MenuItem: English [check if active]
  â”œâ”€ Separator
  â”œâ”€ Label: "Tema" / "Theme"
  â”œâ”€ MenuItem: â˜€ Claro/Light [check if active]
  â”œâ”€ MenuItem: ðŸŒ™ Oscuro/Dark [check if active]
  â”œâ”€ Separator
  â””â”€ MenuItem: Cerrar sesion / Sign out â†’ navigates to /logout
```

- Use Phosphor icons: `GlobeIcon`, `SunIcon`, `MoonIcon`, `CheckIcon`, `SignOutIcon`, `CaretDownIcon`
- On language/theme change:
  1. Update Zustand store (instant UI update)
  2. Fire `api.users.update` mutation via `useMutationWithToast` (async, no success toast needed â€” use silent variant or just `useMutation`)
- Labels use `useTranslation('common')` so they translate themselves

### `AppHeader` changes

- Remove the inline email `<span>` and "Sign out" `<Button>`
- Add `<PreferencesDropdown userId={user._id} authKitId={...} />` in the right section
- Need to pass `authKitId` â€” get from route loader data or add to user hook

## Definition of Done

- [ ] Dropdown renders in header with language/theme sections
- [ ] Selecting a language updates UI language immediately
- [ ] Selecting a theme toggles light/dark immediately
- [ ] Sign out link works
- [ ] Preference changes persist to Convex DB
- [ ] Dropdown labels translate when language changes
- [ ] Current selection shows check mark
