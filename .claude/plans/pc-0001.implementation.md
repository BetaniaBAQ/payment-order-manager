# PC-0001: Super Admin Helpers

## Summary

New `convex/lib/admin.ts` with two helpers: `isSuperAdmin` (pure check) and `assertSuperAdmin` (ctx-aware guard that looks up user by authKitId and throws if not super admin).

## Changes

### New: `convex/lib/admin.ts`

```ts
import { ConvexError } from 'convex/values'

import type { MutationCtx, QueryCtx } from '../_generated/server'

function getSuperAdminEmails(): string[] {
  const raw = process.env.SUPER_ADMIN_EMAILS ?? ''
  return raw
    .split(',')
    .map((e) => e.trim().toLowerCase())
    .filter(Boolean)
}

export function isSuperAdmin(email: string): boolean {
  return getSuperAdminEmails().includes(email.toLowerCase())
}

export async function assertSuperAdmin(
  ctx: QueryCtx | MutationCtx,
  authKitId: string,
): Promise<void> {
  const user = await ctx.db
    .query('users')
    .withIndex('by_authKitId', (q) => q.eq('authKitId', authKitId))
    .first()

  if (!user || user.deletedAt) {
    throw new ConvexError({ code: 'FORBIDDEN', message: 'Not authorized' })
  }

  if (!isSuperAdmin(user.email)) {
    throw new ConvexError({ code: 'FORBIDDEN', message: 'Not authorized' })
  }
}
```

## Patterns followed

- `process.env` for Convex env vars (matches existing `convex/emails.ts`)
- Index query for user lookup (matches `convex/users.ts:getByAuthKitId`)
- `ConvexError` with code/message shape (matches existing error pattern)
- Guard clause style
- Accepts `QueryCtx | MutationCtx` so it works in both queries and mutations

## Files

- `convex/lib/admin.ts` (new)
